<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LukInterLab Business OS | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ö–æ–Ω—Ü–µ–ø—Ü–∏—è</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Markdown Parser (marked) for AI responses -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Chosen Palette: Corporate Clean (Slate/Blue/Emerald) -->
    <!-- Application Structure Plan: 
         1. Hero Section: Conceptual comparison (Hammer vs CNC).
         2. Interactive Architecture: 4-Quadrant grid representing the 4 AI Agent layers. Clicking a layer reveals its logic and a REAL LLM chat interaction.
         3. Dashboard Simulator: A functional mock-up with Gemini-powered Analysis and Action Generation.
         4. Impact Analysis: Data visualization.
    -->
    <!-- Visualization & Content Choices:
         - Chat: Replaced static simulation with real Gemini API calls. Added input field.
         - Dashboard: Added "AI Analysis" button to trigger Gemini insight on chart data.
         - Alerts: "Resolve" buttons now generate content via Gemini before closing.
         - Confirmation: NO SVG graphics used. NO Mermaid JS used.
    -->

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8FAFC;
            /* Slate 50 */
            color: #1E293B;
            /* Slate 800 */
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 300px;
            margin: 0 auto;
        }

        .agent-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .agent-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .agent-card.active {
            border-color: #3B82F6;
            background-color: #EFF6FF;
            /* Blue 50 */
        }

        .chat-bubble {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 12px;
            margin-bottom: 10px;
            font-size: 0.95rem;
            line-height: 1.5;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
            word-wrap: break-word;
        }

        .chat-user {
            background-color: #E2E8F0;
            align-self: flex-end;
            margin-left: auto;
            color: #334155;
            border-bottom-right-radius: 2px;
        }

        .chat-ai {
            background-color: #3B82F6;
            color: white;
            align-self: flex-start;
            border-bottom-left-radius: 2px;
        }

        .chat-ai strong {
            font-weight: 600;
        }

        /* Markdown styles within chat */
        .chat-ai p {
            margin-bottom: 0.5em;
        }

        .chat-ai p:last-child {
            margin-bottom: 0;
        }

        .chat-ai ul {
            list-style-type: disc;
            margin-left: 1.5em;
            margin-bottom: 0.5em;
        }

        .chat-ai ol {
            list-style-type: decimal;
            margin-left: 1.5em;
            margin-bottom: 0.5em;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        /* Custom scrollbar for chat */
        .chat-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .chat-scroll::-webkit-scrollbar-track {
            background: #F1F5F9;
        }

        .chat-scroll::-webkit-scrollbar-thumb {
            background-color: #CBD5E1;
            border-radius: 20px;
        }

        .notification {
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Modal Styles */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {

            0%,
            20% {
                color: rgba(0, 0, 0, 0);
                text-shadow: .25em 0 0 rgba(0, 0, 0, 0), .5em 0 0 rgba(0, 0, 0, 0);
            }

            40% {
                color: white;
                text-shadow: .25em 0 0 rgba(0, 0, 0, 0), .5em 0 0 rgba(0, 0, 0, 0);
            }

            60% {
                text-shadow: .25em 0 0 white, .5em 0 0 rgba(0, 0, 0, 0);
            }

            80%,
            100% {
                text-shadow: .25em 0 0 white, .5em 0 0 white;
            }
        }
    </style>
</head>

<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-slate-800 tracking-tight">LukInterLab <span
                            class="text-blue-600">OS</span></span>
                </div>
                <div class="hidden sm:flex space-x-8 items-center">
                    <a href="#philosophy"
                        class="text-slate-500 hover:text-blue-600 px-3 py-2 text-sm font-medium">–§–∏–ª–æ—Å–æ—Ñ–∏—è</a>
                    <a href="#architecture"
                        class="text-slate-500 hover:text-blue-600 px-3 py-2 text-sm font-medium">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</a>
                    <a href="#dashboard" class="text-slate-500 hover:text-blue-600 px-3 py-2 text-sm font-medium">–î–µ–º–æ:
                        –£—Ç—Ä–æ –î–∏—Ä–µ–∫—Ç–æ—Ä–∞</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow">

        <!-- Hero / Philosophy Section -->
        <section id="philosophy" class="py-16 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl font-extrabold text-slate-900 sm:text-5xl mb-6">
                    –û—Ç "–ú–æ–ª–æ—Ç–∫–∞" –∫ "–°—Ç–∞–Ω–∫—É —Å –ß–ü–£"
                </h1>
                <p class="max-w-2xl mx-auto text-xl text-slate-500 mb-12">
                    –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Å–æ—Ñ—Ç –ø–∞—Å—Å–∏–≤–µ–Ω. LukInterLab OS ‚Äî —ç—Ç–æ –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –≥–¥–µ –ò–ò-–∞–≥–µ–Ω—Ç—ã (Gemini Pro)
                    —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –æ–ø–µ—Ä–µ–∂–µ–Ω–∏–µ.
                </p>

                <!-- Interactive Comparison -->
                <div class="bg-slate-50 rounded-2xl p-8 border border-slate-200 shadow-sm max-w-4xl mx-auto">
                    <div class="flex flex-col md:flex-row gap-8 items-center justify-center">
                        <!-- Old Way -->
                        <div class="flex-1 text-center p-6 bg-white rounded-xl shadow-sm border border-slate-100 opacity-60 transition-opacity duration-300"
                            id="old-way-card">
                            <div class="text-4xl mb-4">üî®</div>
                            <h3 class="text-lg font-bold mb-2">–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –°–æ—Ñ—Ç</h3>
                            <p class="text-sm text-slate-500">Notion, Excel, CRM</p>
                            <div class="mt-4 text-left text-sm text-slate-600 space-y-2">
                                <p>‚ùå –ñ–¥–µ—Ç –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö</p>
                                <p>‚ùå –ß–µ–ª–æ–≤–µ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –≤—Å—ë</p>
                                <p>‚ùå –î–∞–Ω–Ω—ã–µ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω—ã</p>
                            </div>
                        </div>

                        <!-- Switch -->
                        <div class="flex flex-col items-center">
                            <button onclick="toggleEvolution()"
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transform transition hover:scale-105 flex items-center gap-2">
                                <span>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ò–ò</span>
                                <span>üöÄ</span>
                            </button>
                        </div>

                        <!-- New Way -->
                        <div class="flex-1 text-center p-6 bg-white rounded-xl shadow-md border-2 border-blue-100 transform scale-105"
                            id="new-way-card">
                            <div class="text-4xl mb-4">ü§ñ</div>
                            <h3 class="text-lg font-bold mb-2 text-blue-900">LukInterLab OS</h3>
                            <p class="text-sm text-blue-600">–¶–∏—Ñ—Ä–æ–≤–æ–π –î–≤–æ–π–Ω–∏–∫</p>
                            <div class="mt-4 text-left text-sm text-slate-600 space-y-2">
                                <p>‚úÖ –°–∞–º –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á–∏</p>
                                <p>‚úÖ –ê–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ</p>
                                <p>‚úÖ –ï–¥–∏–Ω—ã–π ¬´–ú–æ–∑–≥¬ª –∫–æ–º–ø–∞–Ω–∏–∏</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Architecture Section -->
        <section id="architecture" class="py-16 bg-slate-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="mb-10">
                    <h2 class="text-3xl font-bold text-slate-900">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏</h2>
                    <p class="mt-4 text-lg text-slate-600">
                        –ß–µ—Ç—ã—Ä–µ —É—Ä–æ–≤–Ω—è –ò–ò-–∞–≥–µ–Ω—Ç–æ–≤. –í—ã–±–µ—Ä–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞ –∏ –ø–æ—Å—Ç–∞–≤—å—Ç–µ –µ–º—É –∑–∞–¥–∞—á—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å (Powered by
                        Gemini).
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 h-full">

                    <!-- Left: Agent Selector -->
                    <div class="lg:col-span-1 space-y-4">
                        <!-- Level 1 -->
                        <div onclick="selectAgent('secretary')" id="card-secretary"
                            class="agent-card active bg-white p-5 rounded-xl border border-slate-200">
                            <div class="flex items-center gap-4">
                                <div class="bg-indigo-100 p-3 rounded-lg text-2xl">üì®</div>
                                <div>
                                    <h4 class="font-bold text-slate-800">–£—Ä–æ–≤–µ–Ω—å 1: –°–µ–∫—Ä–µ—Ç–∞—Ä—å</h4>
                                    <p class="text-xs text-slate-500 uppercase tracking-wide">–í—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫</p>
                                </div>
                            </div>
                        </div>
                        <!-- Level 2 -->
                        <div onclick="selectAgent('foreman')" id="card-foreman"
                            class="agent-card bg-white p-5 rounded-xl border border-slate-200">
                            <div class="flex items-center gap-4">
                                <div class="bg-orange-100 p-3 rounded-lg text-2xl">üë∑</div>
                                <div>
                                    <h4 class="font-bold text-slate-800">–£—Ä–æ–≤–µ–Ω—å 2: –ü—Ä–æ—Ä–∞–±</h4>
                                    <p class="text-xs text-slate-500 uppercase tracking-wide">–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ</p>
                                </div>
                            </div>
                        </div>
                        <!-- Level 3 -->
                        <div onclick="selectAgent('auditor')" id="card-auditor"
                            class="agent-card bg-white p-5 rounded-xl border border-slate-200">
                            <div class="flex items-center gap-4">
                                <div class="bg-emerald-100 p-3 rounded-lg text-2xl">‚öñÔ∏è</div>
                                <div>
                                    <h4 class="font-bold text-slate-800">–£—Ä–æ–≤–µ–Ω—å 3: –ê—É–¥–∏—Ç–æ—Ä</h4>
                                    <p class="text-xs text-slate-500 uppercase tracking-wide">–§–∏–Ω–∞–Ω—Å—ã</p>
                                </div>
                            </div>
                        </div>
                        <!-- Level 4 -->
                        <div onclick="selectAgent('strategist')" id="card-strategist"
                            class="agent-card bg-white p-5 rounded-xl border border-slate-200">
                            <div class="flex items-center gap-4">
                                <div class="bg-purple-100 p-3 rounded-lg text-2xl">üß†</div>
                                <div>
                                    <h4 class="font-bold text-slate-800">–£—Ä–æ–≤–µ–Ω—å 4: –°—Ç—Ä–∞—Ç–µ–≥</h4>
                                    <p class="text-xs text-slate-500 uppercase tracking-wide">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Simulation Area -->
                    <div
                        class="lg:col-span-2 bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-[600px]">
                        <!-- Header -->
                        <div class="bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                            <div>
                                <h3 id="sim-title" class="text-xl font-bold text-slate-800">–°—Ü–µ–Ω–∞—Ä–∏–π: –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏–¥–∞
                                </h3>
                                <p id="sim-desc" class="text-sm text-slate-500">–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ 02:00 –Ω–æ—á–∏
                                </p>
                            </div>
                            <span
                                class="px-3 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700 flex items-center gap-1">
                                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span> LIVE (Gemini)
                            </span>
                        </div>

                        <!-- Chat Area -->
                        <div id="chat-container"
                            class="flex-1 p-6 overflow-y-auto chat-scroll flex flex-col gap-3 bg-slate-50/50">
                            <!-- Dynamic Content -->
                        </div>

                        <!-- Controls -->
                        <div class="p-4 bg-white border-t border-slate-100">
                            <form id="chat-form" onsubmit="handleChatSubmit(event)" class="flex gap-2">
                                <input type="text" id="chat-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç—É..."
                                    class="flex-1 border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                                <button type="submit"
                                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition flex items-center gap-2">
                                    <span>‚û§</span>
                                </button>
                            </form>
                            <p class="text-[10px] text-slate-400 mt-2 text-center">–ò–ò –º–æ–∂–µ—Ç –¥–æ–ø—É—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ
                                –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="py-16 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="mb-10">
                    <h2 class="text-3xl font-bold text-slate-900">–î–µ–º–æ: –£—Ç—Ä–æ –î–∏—Ä–µ–∫—Ç–æ—Ä–∞</h2>
                    <p class="mt-4 text-lg text-slate-600">
                        –í–º–µ—Å—Ç–æ –¥–µ—Å—è—Ç–∫–∞ –≤–∫–ª–∞–¥–æ–∫ ‚Äî –æ–¥–∏–Ω —ç–∫—Ä–∞–Ω.
                    </p>
                </div>

                <!-- Dashboard Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">

                    <!-- Metrics Column -->
                    <div class="lg:col-span-8 space-y-6">
                        <!-- Stats Cards -->
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                                <p class="text-sm text-slate-500 mb-1">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –≤—á–µ—Ä–∞</p>
                                <p class="text-2xl font-bold text-slate-900">0 ‚ÇΩ</p>
                                <span class="text-xs text-slate-400">---</span>
                            </div>
                            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                                <p class="text-sm text-slate-500 mb-1">–ü–æ—Ç—Ä–∞—á–µ–Ω–æ –≤—á–µ—Ä–∞</p>
                                <p class="text-2xl font-bold text-red-600">5 000 ‚ÇΩ</p>
                                <span class="text-xs text-red-400">‚Üë 12% –∫ –Ω–æ—Ä–º–µ</span>
                            </div>
                            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                                <p class="text-sm text-slate-500 mb-1">–ü—Ä–æ–≥–Ω–æ–∑ —Ä–∞–∑—Ä—ã–≤–∞</p>
                                <p class="text-2xl font-bold text-orange-500">—á–µ—Ä–µ–∑ 5 –¥–Ω–µ–π</p>
                                <span class="text-xs text-orange-400">–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è</span>
                            </div>
                        </div>

                        <!-- Main Chart -->
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm relative">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-slate-800">–î–≤–∏–∂–µ–Ω–∏–µ –î–µ–Ω–µ–∂–Ω—ã—Ö –°—Ä–µ–¥—Å—Ç–≤</h3>
                                <div class="flex gap-2 items-center">
                                    <button onclick="analyzeCashflow()"
                                        class="text-xs bg-purple-100 text-purple-700 px-3 py-1.5 rounded-full font-bold hover:bg-purple-200 transition flex items-center gap-1">
                                        ‚ú® AI –ê–Ω–∞–ª–∏–∑
                                    </button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="cashflowChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Action Column -->
                    <div class="lg:col-span-4 space-y-6">
                        <!-- AI Alert Panel -->
                        <div class="bg-red-50 p-6 rounded-xl border border-red-100">
                            <div class="flex items-center gap-2 mb-4">
                                <span class="text-red-500 text-xl">‚ö†Ô∏è</span>
                                <h3 class="font-bold text-red-900">–§–æ–∫—É—Å –í–Ω–∏–º–∞–Ω–∏—è (2)</h3>
                            </div>

                            <div class="space-y-4">
                                <!-- Alert 1 -->
                                <div class="bg-white p-4 rounded-lg shadow-sm border border-red-100" id="alert-1">
                                    <div class="flex justify-between items-start mb-2">
                                        <h4 class="font-semibold text-slate-800 text-sm">–ü—Ä–æ—Å—Ä–æ—á–∫–∞: –ü—Ä–æ–µ–∫—Ç –ê</h4>
                                        <span
                                            class="text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded">–ö—Ä–∏—Ç–∏—á–Ω–æ</span>
                                    </div>
                                    <p class="text-xs text-slate-500 mb-3">–î–µ–¥–ª–∞–π–Ω –±—ã–ª –≤—á–µ—Ä–∞. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –º–æ–ª—á–∏—Ç 3 –¥–Ω—è.
                                    </p>
                                    <button onclick="resolveAlertWithAI('alert-1', 'deadline')"
                                        class="w-full bg-red-600 hover:bg-red-700 text-white text-sm py-2 rounded transition flex justify-center items-center gap-2">
                                        <span>‚ö°</span> –†–µ—à–∏—Ç—å (–ò–ò)
                                    </button>
                                </div>

                                <!-- Alert 2 -->
                                <div class="bg-white p-4 rounded-lg shadow-sm border border-orange-100" id="alert-2">
                                    <div class="flex justify-between items-start mb-2">
                                        <h4 class="font-semibold text-slate-800 text-sm">–°—á–µ—Ç –Ω–µ –æ–ø–ª–∞—á–µ–Ω</h4>
                                        <span
                                            class="text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded">–§–∏–Ω–∞–Ω—Å—ã</span>
                                    </div>
                                    <p class="text-xs text-slate-500 mb-3">–•–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä. –°—É–º–º–∞: 5 000 ‚ÇΩ.</p>
                                    <button onclick="resolveAlertWithAI('alert-2', 'payment')"
                                        class="w-full bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 text-sm py-2 rounded transition flex justify-center items-center gap-2">
                                        <span>‚ö°</span> –û–ø–ª–∞—Ç–∏—Ç—å (–ò–ò)
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
                            <h3 class="font-bold text-slate-800 mb-4 text-sm uppercase tracking-wide">–ü–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
                            </h3>
                            <ul class="space-y-3 text-sm text-slate-600">
                                <li class="flex items-center gap-2">
                                    <span
                                        class="w-4 h-4 rounded-full border border-slate-300 flex items-center justify-center text-[10px] text-transparent hover:text-slate-500 cursor-pointer">‚úì</span>
                                    –ó–≤–æ–Ω–æ–∫ –∫–ª–∏–µ–Ω—Ç—É "–°—Ç—Ä–æ–π–ú–∞—à"
                                </li>
                                <li class="flex items-center gap-2">
                                    <span
                                        class="w-4 h-4 rounded-full border border-slate-300 flex items-center justify-center text-[10px] text-transparent hover:text-slate-500 cursor-pointer">‚úì</span>
                                    –ü–æ–¥–ø–∏—Å–∞—Ç—å –∞–∫—Ç—ã (–ò–ò –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª)
                                </li>
                                <li class="flex items-center gap-2">
                                    <span
                                        class="w-4 h-4 rounded-full border border-slate-300 flex items-center justify-center text-[10px] text-transparent hover:text-slate-500 cursor-pointer">‚úì</span>
                                    –í—Å—Ç—Ä–µ—á–∞ —Å –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–º
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Impact / Comparison Section -->
        <section class="py-16 bg-slate-50 border-t border-slate-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <div>
                        <h2 class="text-3xl font-bold text-slate-900 mb-6">–†–µ–∑—É–ª—å—Ç–∞—Ç –í–Ω–µ–¥—Ä–µ–Ω–∏—è</h2>
                        <p class="text-lg text-slate-600 mb-6">
                            –ú—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º —Å–æ—Ñ—Ç, –º—ã –º–µ–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è.
                        </p>
                        <ul class="space-y-4">
                            <li class="flex items-start gap-3">
                                <div class="mt-1 bg-green-100 p-1 rounded text-green-600 text-sm">üìâ</div>
                                <div>
                                    <span class="font-bold text-slate-800">-80% –†—É—Ç–∏–Ω—ã</span>
                                    <p class="text-sm text-slate-500">–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç.
                                    </p>
                                </div>
                            </li>
                            <li class="flex items-start gap-3">
                                <div class="mt-1 bg-blue-100 p-1 rounded text-blue-600 text-sm">üìà</div>
                                <div>
                                    <span class="font-bold text-slate-800">+100% –ö–æ–Ω—Ç—Ä–æ–ª—è</span>
                                    <p class="text-sm text-slate-500">–ù–∏ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è, –Ω–∏ –æ–¥–∏–Ω —Ä—É–±–ª—å –Ω–µ
                                        –ø—Ä–æ–ø–∞–¥–∞–µ—Ç.</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                            <h3 class="font-bold text-slate-800 mb-4 text-center">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –î–∏—Ä–µ–∫—Ç–æ—Ä–∞</h3>
                            <div class="chart-container">
                                <canvas id="impactChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-2xl font-bold mb-4">LukInterLab OS</h3>
                    <p class="text-slate-400 text-sm">
                        –ü–µ—Ä–≤–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.
                        –ë—É–¥—É—â–µ–µ –Ω–∞—Å—Ç—É–ø–∏–ª–æ.
                    </p>
                </div>
                <div>
                    <h4 class="font-bold mb-4 uppercase text-sm tracking-wider text-slate-500">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <p class="mb-2">–°–µ—Ä–≥–µ–π –õ—É–∫—å—è–Ω–æ–≤, CEO</p>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded transition">
                        –°–≤—è–∑–∞—Ç—å—Å—è –≤ Telegram
                    </button>
                </div>
                <div>
                    <h4 class="font-bold mb-4 uppercase text-sm tracking-wider text-slate-500">–î–æ–∫—É–º–µ–Ω—Ç—ã</h4>
                    <ul class="space-y-2 text-sm text-slate-400">
                        <li><a href="#" class="hover:text-white">White Paper</a></li>
                        <li><a href="#" class="hover:text-white">–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è</a></li>
                        <li><a href="#" class="hover:text-white">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-12 pt-8 border-t border-slate-800 text-center text-xs text-slate-600">
                &copy; 2026 LukInterLab. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
            </div>
        </div>
    </footer>

    <!-- Notification Toast -->
    <div id="notification-toast"
        class="fixed bottom-5 right-5 bg-slate-800 text-white px-6 py-4 rounded-lg shadow-xl z-50 hidden notification flex items-center gap-3">
        <span class="text-green-400 text-xl">‚úì</span>
        <div>
            <h4 class="font-bold text-sm">–î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</h4>
            <p class="text-xs text-slate-300" id="toast-message">–û–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è...</p>
        </div>
    </div>

    <!-- AI Modal -->
    <div id="ai-modal" class="fixed inset-0 modal-overlay hidden z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full overflow-hidden transform transition-all scale-95 opacity-0"
            id="ai-modal-content">
            <div class="bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                <h3 class="font-bold text-slate-800 flex items-center gap-2">‚ú® LukInterLab AI</h3>
                <button onclick="closeAIModal()" class="text-slate-400 hover:text-slate-600">&times;</button>
            </div>
            <div class="p-6">
                <div id="ai-modal-loading" class="text-center py-8 hidden">
                    <div class="text-4xl mb-4 animate-bounce">ü§ñ</div>
                    <p class="text-slate-500 font-medium">–ê–≥–µ–Ω—Ç –¥—É–º–∞–µ—Ç<span class="loading-dots"></span></p>
                </div>
                <div id="ai-modal-result" class="text-sm text-slate-700 space-y-2 max-h-[60vh] overflow-y-auto">
                    <!-- Content -->
                </div>
            </div>
            <div class="bg-slate-50 px-6 py-4 border-t border-slate-100 flex justify-end gap-2">
                <button onclick="closeAIModal()"
                    class="px-4 py-2 text-sm text-slate-500 hover:text-slate-700">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button id="ai-modal-confirm"
                    class="px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 hidden">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = ""; // API Key injected by environment

        // --- GEMINI API CALLER ---
        async function callGemini(prompt, systemInstruction = "–¢—ã –±–∏–∑–Ω–µ—Å-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.") {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: systemInstruction }] }
                    })
                });

                if (!response.ok) {
                    // Check if it's a 429 (Too Many Requests) or other error
                    if (response.status === 429) throw new Error("–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ò–ò –æ—Ç–¥—ã—Ö–∞–µ—Ç...");
                    throw new Error(`–û—à–∏–±–∫–∞ API: ${response.status}`);
                }

                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç –ò–ò.";
            } catch (error) {
                console.error(error);
                return "–ò–∑–≤–∏–Ω–∏—Ç–µ, —Å–µ–π—á–∞—Å —è –Ω–µ –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";
            }
        }

        // --- DATA & STATE ---
        const agentData = {
            secretary: {
                title: "–°–µ–∫—Ä–µ—Ç–∞—Ä—å (–ò–ò)",
                desc: "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –ª–∏–¥—ã 24/7",
                greeting: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –ò–ò-—Å–µ–∫—Ä–µ—Ç–∞—Ä—å. –í–∏–∂—É, –≤—ã –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å –Ω–∞—à–∏–º–∏ —É—Å–ª—É–≥–∞–º–∏. –ö–∞–∫–æ–π —É –≤–∞—Å –±—é–¥–∂–µ—Ç –Ω–∞ –ø—Ä–æ–µ–∫—Ç?",
                systemPrompt: "–¢—ã ‚Äî –ò–ò-—Å–µ–∫—Ä–µ—Ç–∞—Ä—å –≤–µ–±-—Å—Ç—É–¥–∏–∏ LukInterLab. –¢–≤–æ—è —Ü–µ–ª—å ‚Äî –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–∏–¥–∞. –ë—É–¥—å –≤–µ–∂–ª–∏–≤, –∫—Ä–∞—Ç–æ–∫. –°–ø—Ä–∞—à–∏–≤–∞–π –ø—Ä–æ –±—é–¥–∂–µ—Ç, —Å—Ä–æ–∫–∏ –∏ –¢–ó. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç –ø—Ä–æ –±—é–¥–∂–µ—Ç, –æ—Ü–µ–Ω–∏–≤–∞–π, –ø–æ–¥—Ö–æ–¥–∏—Ç –ª–∏ —ç—Ç–æ –Ω–∞–º (–æ—Ç 100–∫). –ù–µ –ø–∏—à–∏ –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã."
            },
            foreman: {
                title: "–ü—Ä–æ—Ä–∞–± (–ò–ò)",
                desc: "–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á–∏ –∏ —Å—Ä–æ–∫–∏",
                greeting: "–ü—Ä–∏–≤–µ—Ç! –Ø —Å–ª–µ–∂—É –∑–∞ —Å—Ä–æ–∫–∞–º–∏. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å –ø–æ —Ç–µ–∫—É—â–∏–º –ø—Ä–æ–µ–∫—Ç–∞–º?",
                systemPrompt: "–¢—ã ‚Äî —Å—Ç—Ä–æ–≥–∏–π, –Ω–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–π –ò–ò-–ø—Ä–æ—Ä–∞–± (Project Manager). –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–∏–Ω–∞—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∑–∞ –ø—Ä–æ—Å—Ä–æ—á–∫–∏. –¢–≤–æ–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è: —á–µ—Ç–∫–∏–π, –¥–µ–ª–æ–≤–æ–π, –Ω–µ–º–Ω–æ–≥–æ –Ω–∞–ø–æ—Ä–∏—Å—Ç—ã–π. –¢—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –∑–∞–¥–∞—á–∞–º–∏ –≤ Jira/Trello."
            },
            auditor: {
                title: "–ê—É–¥–∏—Ç–æ—Ä (–ò–ò)",
                desc: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã",
                greeting: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –ì–æ—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞—à–∏ —Å—á–µ—Ç–∞ –∏–ª–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã.",
                systemPrompt: "–¢—ã ‚Äî –ò–ò-–∞—É–¥–∏—Ç–æ—Ä. –¢—ã –ø–µ–¥–∞–Ω—Ç–∏—á–µ–Ω, –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω –∫ —Ü–∏—Ñ—Ä–∞–º. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –∫–∞—Å—Å–æ–≤—ã–µ —Ä–∞–∑—Ä—ã–≤—ã –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —á–µ–∫–∏. –ï—Å–ª–∏ –≤–∏–¥–∏—à—å –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–π —Å—Ç—Ä–æ–≥–æ."
            },
            strategist: {
                title: "–°—Ç—Ä–∞—Ç–µ–≥ (–ò–ò)",
                desc: "–ü–æ–∏—Å–∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞",
                greeting: "–°–µ—Ä–≥–µ–π, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é. –ï—Å—Ç—å –∏–¥–µ–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞–ª–æ–≥–æ–≤ –∏–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏?",
                systemPrompt: "–¢—ã ‚Äî –ò–ò-—Å—Ç—Ä–∞—Ç–µ–≥, —Å–æ–≤–µ—Ç–Ω–∏–∫ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞. –¢—ã –º—ã—Å–ª–∏—à—å –º–∞—Å—à—Ç–∞–±–Ω–æ, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—à—å –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å –∑–∞–∫–æ–Ω—ã –†–§. –¢–≤–æ–π —Ç–æ–Ω: —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π, —Å–ø–æ–∫–æ–π–Ω—ã–π, —É–≤–µ—Ä–µ–Ω–Ω—ã–π."
            }
        };

        let currentAgent = 'secretary';
        let cashflowChartInstance = null;

        // --- FUNCTIONS ---

        // 1. Philosophy Toggle
        function toggleEvolution() {
            const btn = document.querySelector('button[onclick="toggleEvolution()"]');
            const oldCard = document.getElementById('old-way-card');

            oldCard.style.opacity = '0.3';
            oldCard.style.transform = 'scale(0.95)';

            btn.innerHTML = "<span>–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞</span><span>‚úÖ</span>";
            btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            btn.classList.add('bg-emerald-600', 'hover:bg-emerald-700');

            setTimeout(() => {
                document.getElementById('architecture').scrollIntoView({ behavior: 'smooth' });
            }, 800);
        }

        // 2. Architecture Selection
        function selectAgent(agentKey) {
            currentAgent = agentKey;

            // UI Update
            document.querySelectorAll('.agent-card').forEach(card => {
                card.classList.remove('active');
                card.classList.remove('bg-blue-50');
            });
            document.getElementById(`card-${agentKey}`).classList.add('active');

            // Update Headers
            const data = agentData[agentKey];
            document.getElementById('sim-title').innerText = data.title;
            document.getElementById('sim-desc').innerText = data.desc;

            // Clear & Reset Chat
            const chatContainer = document.getElementById('chat-container');
            chatContainer.innerHTML = '';

            // Add Greeting
            appendMessage('ai', data.greeting);
        }

        // 3. Chat Logic
        async function handleChatSubmit(e) {
            e.preventDefault();
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if (!text) return;

            appendMessage('user', text);
            input.value = '';

            // Show typing indicator logic if needed, but appendMessage handles static UI
            const loadingId = appendMessage('ai', '...');

            // Call API
            const response = await callGemini(text, agentData[currentAgent].systemPrompt);

            // Update bubble with response
            const bubble = document.getElementById(loadingId);
            if (bubble) bubble.innerHTML = marked.parse(response);
        }

        function appendMessage(role, text) {
            const chatContainer = document.getElementById('chat-container');
            const bubble = document.createElement('div');
            const id = 'msg-' + Date.now();
            bubble.id = id;
            bubble.classList.add('chat-bubble');

            if (role === 'ai') {
                bubble.classList.add('chat-ai');
                // Use marked only if it's not the initial loading dots
                bubble.innerHTML = text === '...' ? text : marked.parse(text);
            } else {
                bubble.classList.add('chat-user');
                bubble.innerText = text;
            }

            chatContainer.appendChild(bubble);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return id;
        }

        // 4. AI Modal & Analysis Logic
        function showAIModal() {
            const modal = document.getElementById('ai-modal');
            const content = document.getElementById('ai-modal-content');
            modal.classList.remove('hidden');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);

            document.getElementById('ai-modal-result').innerHTML = '';
            document.getElementById('ai-modal-loading').classList.remove('hidden');
            document.getElementById('ai-modal-confirm').classList.add('hidden');
        }

        function closeAIModal() {
            const modal = document.getElementById('ai-modal');
            const content = document.getElementById('ai-modal-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // Analyze Cashflow Chart
        async function analyzeCashflow() {
            showAIModal();
            const chartData = {
                labels: ['1 —è–Ω–≤', '5 —è–Ω–≤', '10 —è–Ω–≤', '15 —è–Ω–≤', '20 —è–Ω–≤', '25 —è–Ω–≤', '30 —è–Ω–≤'],
                fact: [100000, 95000, 120000, 110000, 105000],
                forecast: [105000, 45000, -15000]
            };

            const prompt = `–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Ç–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ (—Ä—É–±–ª–∏). 
            –§–∞–∫—Ç (–¥–æ 20 —è–Ω–≤): ${chartData.fact.join(', ')}. 
            –ü—Ä–æ–≥–Ω–æ–∑ –ò–ò (—Å 20 —è–Ω–≤): ${chartData.forecast.join(', ')}. 
            –ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ -15000. 
            –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏ —Ç—Ä–µ–Ω–¥, —É–∫–∞–∂–∏ –¥–∞—Ç—É –∫–∞—Å—Å–æ–≤–æ–≥–æ —Ä–∞–∑—Ä—ã–≤–∞ –∏ –¥–∞–π 1 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–æ–≤–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä—É.`;

            const response = await callGemini(prompt, "–¢—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ, –∏—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏.");

            document.getElementById('ai-modal-loading').classList.add('hidden');
            document.getElementById('ai-modal-result').innerHTML = marked.parse(response);
        }

        // Resolve Alerts with AI Generation
        let pendingAlertId = '';

        async function resolveAlertWithAI(alertId, type) {
            showAIModal();
            pendingAlertId = alertId;
            let prompt = "";
            let system = "";
            let btnText = "";

            if (type === 'deadline') {
                prompt = "–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ, –Ω–æ —Å—Ç—Ä–æ–≥–æ–µ –ø–∏—Å—å–º–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é (—Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä—É) –æ –ø—Ä–æ—Å—Ä–æ—á–∫–µ –¥–µ–¥–ª–∞–π–Ω–∞ –ø–æ –ü—Ä–æ–µ–∫—Ç—É –ê. –°–ø—Ä–æ—Å–∏, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.";
                system = "–¢—ã –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤. –ë—É–¥—å –∫—Ä–∞—Ç–æ–∫.";
                btnText = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å";
            } else if (type === 'payment') {
                prompt = "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Ç–µ–∫—Å—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ –¥–ª—è –±–∞–Ω–∫–∞: –û–ø–ª–∞—Ç–∞ —Ö–æ—Å—Ç–∏–Ω–≥–∞, —Å—á–µ—Ç ‚Ññ555, —Å—É–º–º–∞ 5000 —Ä—É–±. –ë–µ–∑ –ù–î–°.";
                system = "–¢—ã –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–æ—Ç.";
                btnText = "–û–ø–ª–∞—Ç–∏—Ç—å";
            }

            const response = await callGemini(prompt, system);

            document.getElementById('ai-modal-loading').classList.add('hidden');
            document.getElementById('ai-modal-result').innerHTML = `
                <p class="text-xs text-slate-400 mb-2 uppercase font-bold">–ò–ò —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –¥–µ–π—Å—Ç–≤–∏–µ:</p>
                <div class="bg-slate-100 p-3 rounded border border-slate-200 italic">
                    ${marked.parse(response)}
                </div>
            `;

            const confirmBtn = document.getElementById('ai-modal-confirm');
            confirmBtn.innerText = btnText;
            confirmBtn.classList.remove('hidden');
            confirmBtn.onclick = () => confirmResolution(alertId, response);
        }

        function confirmResolution(alertId, aiText) {
            closeAIModal();
            const el = document.getElementById(alertId);
            el.style.transition = "all 0.5s";
            el.style.opacity = "0";
            el.style.transform = "translateX(50px)";

            setTimeout(() => {
                el.style.display = "none";
                showToast("–î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ò–ò");
            }, 500);
        }

        function showToast(msg) {
            const toast = document.getElementById('notification-toast');
            document.getElementById('toast-message').innerText = msg;
            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 4000);
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', function () {
            selectAgent('secretary'); // Init chat

            // 1. Cashflow Chart
            const ctxCashflow = document.getElementById('cashflowChart').getContext('2d');
            cashflowChartInstance = new Chart(ctxCashflow, {
                type: 'line',
                data: {
                    labels: ['1 —è–Ω–≤', '5 —è–Ω–≤', '10 —è–Ω–≤', '15 —è–Ω–≤', '20 —è–Ω–≤', '25 —è–Ω–≤', '30 —è–Ω–≤'],
                    datasets: [
                        {
                            label: '–ë–∞–ª–∞–Ω—Å (–§–∞–∫—Ç)',
                            data: [100000, 95000, 120000, 110000, 105000, null, null],
                            borderColor: '#10B981', // Emerald
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: '–ü—Ä–æ–≥–Ω–æ–∑ –ò–ò',
                            data: [null, null, null, null, 105000, 45000, -15000], // Shows dip below zero
                            borderColor: '#94A3B8', // Slate 400
                            borderDash: [5, 5],
                            tension: 0.4,
                            pointStyle: 'rectRot'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: 0,
                                    yMax: 0,
                                    borderColor: 'red',
                                    borderWidth: 2,
                                    label: { content: '–ö–∞—Å—Å–æ–≤—ã–π —Ä–∞–∑—Ä—ã–≤', enabled: true, position: 'end' }
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: { color: '#F1F5F9' }
                        },
                        x: { grid: { display: false } }
                    }
                }
            });

            // 2. Impact Chart
            const ctxImpact = document.getElementById('impactChart').getContext('2d');
            new Chart(ctxImpact, {
                type: 'bar',
                data: {
                    labels: ['–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –±–∏–∑–Ω–µ—Å', 'LukInterLab OS'],
                    datasets: [
                        {
                            label: '–†—É—Ç–∏–Ω–∞',
                            data: [80, 15],
                            backgroundColor: '#CBD5E1',
                        },
                        {
                            label: '–°—Ç—Ä–∞—Ç–µ–≥–∏—è',
                            data: [20, 85],
                            backgroundColor: '#3B82F6',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    },
                    scales: {
                        x: { stacked: true, grid: { display: false } },
                        y: { stacked: true, display: false }
                    }
                }
            });
        });

    </script>
</body>

</html>